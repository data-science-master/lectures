"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9096],{60582:function(e,t,a){a.d(t,{U:function(){return h}});var r=a(52322),n=a(72779),o=a.n(n),s=a(2784),c=a(19596),i=a(45103),d=a(46315),l=a(91842),u=a(31885);let h=e=>{let{meterRankChange:t,iconType:a="arrow"}=e,{palette:{baseColor:n}}=(0,s.useContext)(d.Theme),c=l.ICONS.DASH,i=l.ICONS.POPULARITY_NEUTRAL,h="flat";return t&&(t.changeDirection===u.UQd.Up?(c=l.ICONS.ARROW_DROP_UP,i=l.ICONS.POPULARITY_UP,h="up"):t.changeDirection===u.UQd.Down&&(c=l.ICONS.ARROW_DROP_DOWN,i=l.ICONS.POPULARITY_DOWN,h="down")),(0,r.jsx)(f,{name:"trend"===a?i:c,className:o()(n,h,a),type:"inline"})},f=(0,c.default)(i.Icon).withConfig({componentId:"sc-ee671986-0"})(["font-size:1.6em;&.arrow{&.up,&.down{margin-left:-0.2em;margin-right:-0.2em;}&.flat{font-size:0.8em;margin-left:0.1em;margin-right:0.1em;}}&.base{&.flat{","}&.down{","}&.up{","}}&.baseAlt{&.flat{","}&.down{","}&.up{","}}"],(0,l.setPropertyToColorVar)("color","ipt-on-base-textSecondary-color"),(0,l.setPropertyToColorVar)("color","ipt-on-base-accent3-color"),(0,l.setPropertyToColorVar)("color","ipt-on-base-accent4-color"),(0,l.setPropertyToColorVar)("color","ipt-on-baseAlt-textSecondary-color"),(0,l.setPropertyToColorVar)("color","ipt-on-baseAlt-accent3-color"),(0,l.setPropertyToColorVar)("color","ipt-on-baseAlt-accent4-color"))},15030:function(e,t,a){a.d(t,{x:function(){return i}});var r=a(52322);a(2784);var n=a(53665),o=a(19596),s=a(31885),c=a(60582);let i=e=>{let{difference:t,direction:a,formatOptions:o,...i}=e,l=(0,n.Z)(),u=l.formatMessage({id:"rank_meter_no_change",defaultMessage:"No rank change"});switch(a){case s.UQd.Up:u=l.formatMessage({id:"rank_meter_upward_rank_change",defaultMessage:"Moved up {difference} in ranking"},{difference:t});break;case s.UQd.Down:u=l.formatMessage({id:"rank_meter_downward_rank_change",defaultMessage:"Moved down {difference} in ranking"},{difference:t})}return(0,r.jsxs)(d,{...i,"aria-label":u,children:[(0,r.jsx)(c.U,{meterRankChange:{difference:t||0,changeDirection:a}}),void 0!==t&&l.formatNumber(t,o)]})},d=o.default.span.withConfig({componentId:"sc-15fa49cd-0"})(["display:inline-flex;justify-content:center;align-items:center;color:inherit;overflow:hidden;max-height:1em;"])},57708:function(e,t,a){a.d(t,{$:function(){return g}});var r=a(52322);a(2784);var n=a(53665),o=a(19596),s=a(45103),c=a(91842),i=a(22619),d=a(88905),l=a(84314),u=a(66456),h=a(11438),f=a(14438),m=a(43986);let g=e=>{let{titleId:t,titleText:a,className:o}=e,s=(0,i.V)(e=>!!e.watchedTitles[t]),{sendMarkTitleAsWatched:g,sendMarkTitleAsUnwatched:_}=(0,d.b)(),w=(0,n.Z)(),C=(0,l.n)(),p=(0,u.I)(),{value:S}=(0,h.Lz)(),k=(0,f.EO)(),b=e=>{k({pageAction:`${e}-${t}`,refMarkerString:S,customPageMetadata:{id:p}})},M=w.formatMessage(m.TY.watchedButton),W=w.formatMessage(m.TY.markWatchedButton),I=w.formatMessage(m.TY.watchedButtonArialLabel,{titleName:a}),A=w.formatMessage(m.TY.markWatchedButtonAriaLabel,{titleName:a}),x=s?c.ICONS.VISIBILITY_FILLED:c.ICONS.VISIBILITY;return(0,r.jsx)(h.xm,{value:h.Cd.WATCHED,children:(0,r.jsx)(T,{alignContent:"left",ariaLabel:s?I:A,"aria-pressed":s,"data-testid":`inline-watched-button-${t}`,disableIconMargins:!0,onClick:()=>{s?(b(`${m.zq.removeFromWatchedPrefix}`),_(t)):(C?b(`${m.zq.addToWatchedPrefix}`):b(`${m.zq.loggedOutPrefix}`),g(t))},preIcon:x,preIconClassName:m.kA.WATCHED_BUTTON_ICON_CLASSNAME,width:"half-padding",className:o,children:s?M:W})})},T=(0,o.default)(s.TextButton).withConfig({componentId:"sc-78408e02-0"})(["",";.","{width:1rem;margin-right:0.25rem;}"],(0,c.setTypographyType)("bodySmall"),m.kA.WATCHED_BUTTON_ICON_CLASSNAME)},43986:function(e,t,a){a.d(t,{TY:function(){return o},kA:function(){return r},z7:function(){return n},zq:function(){return s}});let r={HIDE_WATCHED_TOGGLE_ID:"hide-watched-toggle",WATCHED_BUTTON_ICON_CLASSNAME:"watched-button--icon"},n={WATCHED_PROGRESS_TEST_ID:"watched-progress-text-wrapper"},o={watchedProgress:{id:"common_watchedProgress_title",defaultMessage:"{currentNumber} OF {totalNumber} WATCHED"},watchedButton:{id:"common_watchedButton_text",defaultMessage:"Watched"},markWatchedButton:{id:"common_markWatchedButton_text",defaultMessage:"Mark as watched"},watchedButtonArialLabel:{id:"common_ariaLabels_watchedButton",defaultMessage:"Watched {titleName}"},markWatchedButtonAriaLabel:{id:"common_ariaLabels_markWatchedButton",defaultMessage:"Mark {titleName} as watched"},watchedButtonLoadingAriaLabel:{id:"common_ariaLabel_loading",defaultMessage:"Loading"},hideTitles:{id:"common_youHaveWatched_hideMessaging",defaultMessage:"Hide watched titles"},addWatchedSuccess:{id:"common_watchedSnackbar_addWatchedSuccess",defaultMessage:"Added to your watch history"},removeWatchedSuccess:{id:"common_watchedSnackbar_removeWatchedSuccess",defaultMessage:"Removed from your watch history"},seeWatchHistory:{id:"common_watchedSnackbar_seeWatchHistory",defaultMessage:"See watch history"},genericError:{id:"confirmation_info_try_again",defaultMessage:"Sorry, something went wrong, please try again"},seeRatings:{id:"common_watchedSnackbar_seeRatingsText",defaultMessage:"See ratings"},seeCheckins:{id:"common_watchedSnackbar_seeCheckinsText",defaultMessage:"See check-ins"},seeReview:{id:"common_watchedSnackbar_seeReviewText",defaultMessage:"See review"},snackShortcutHelper:{id:"common_snack_shortcut",defaultMessage:"{message}. To interact with this alert, use the keyboard shortcut alt + S"},closeLabel:{id:"common_buttons_close",defaultMessage:"Close"}},s={addToWatchedPrefix:"wtchd-add",removeFromWatchedPrefix:"wtchd-del",loggedOutPrefix:"tmp-wtchd",snackBarClosePrefix:"wtchd-snck-close"}},88905:function(e,t,a){a.d(t,{b:function(){return b}});var r=a(30382),n=a.n(r),o=a(54073),s=a.n(o),c=a(2784),i=a(53665),d=a(50100),l=a(43986),u=a(31885),h=a(17503),f=a(41174),m=a(66456),g=a(66724),T=a(11438),_=a(14438),w=a(22619);let C=n()`
    mutation AddWatchedTitle($titleId: ID!) {
        addWatchedTitle(titleId: $titleId) {
            message {
                language
                value
            }
            success
        }
    }
`,p=n()`
    mutation RemoveWatchedTitle($titleId: ID!) {
        removeWatchedTitle(titleId: $titleId) {
            message {
                language
                value
            }
            remainingWatchedSourceTypes
            remainingReview {
                id
            }
            success
        }
    }
`,S=w.V.getState().addToWatchedTitles,k=w.V.getState().removeFromWatchedTitles,b=()=>{let{sendSnack:e}=(0,d.useSnackbar)(),t=(0,m.I)()??"",a=(0,i.Z)(),r=(0,f.nu)(),{value:n}=(0,T.Lz)(),o=(0,_.EO)(),{reviewSingleLinkBuilder:w,userCheckinsLinkBuilder:b,userRatingsLinkBuilder:M,userReviewsLinkBuilder:W,userWatchHistoryLinkBuilder:I}=(0,g.WO)(),[{fetching:A},x]=(0,h.Z)(C,{requireAuth:!0}),[{fetching:y},v]=(0,h.Z)(p,{requireAuth:!0}),N=a.formatMessage(l.TY.addWatchedSuccess),L=a.formatMessage(l.TY.removeWatchedSuccess),O=a.formatMessage(l.TY.genericError),D=a.formatMessage(l.TY.seeWatchHistory),P=a.formatMessage(l.TY.seeCheckins),E=a.formatMessage(l.TY.seeRatings),B=a.formatMessage(l.TY.seeReview),R=a.formatMessage(l.TY.closeLabel),H=async n=>{r&&S(n);let o=await x({titleId:n});if(void 0!==o){if(o?.error||o?.data?.addWatchedTitle?.success===!1)e({type:"auto",baseColor:"accent3",primaryText:O}),r&&k(n);else{let r=a.formatMessage(l.TY.snackShortcutHelper,{message:N});e({type:"auto",baseColor:"base",display:"stacked",textButtons:[{href:I({urconst:t,refSuffix:{t:T.Cd.WATCHED,n:1}}),text:D}],primaryText:N,alertText:r})}}},Y=async r=>{let s=await v({titleId:r}),{message:c,remainingReview:i,remainingWatchedSourceTypes:d=[]}=s?.data?.removeWatchedTitle??{},u=c?.value,h=i?.id,f=d.reduce((e,t)=>{let a=U(t,h);return void 0!==a&&e.push(a),e},[]);if(s?.error||d.length&&!f.length){e({type:"auto",baseColor:"accent3",primaryText:O});return}if(d.length&&f.length){let s=a.formatMessage(l.TY.snackShortcutHelper,{message:u});e({type:"manual",baseColor:"base",display:"stacked",buttonsDisplay:f.length>1?"stacked":"inline",onClose:()=>{o({customPageMetadata:{id:t},pageAction:`${l.zq.snackBarClosePrefix}-${r}`,refMarkerString:n})},closeLabel:R,primaryText:u,textButtons:f,alertText:s});return}e({type:"auto",baseColor:"base",primaryText:L}),k(r)},U=(e,a)=>{switch(e){case u.qcL.Rating:return{href:M({urconst:t,refSuffix:{t:T.Cd.WATCHED,n:1}}),text:E};case u.qcL.Checkin:return{href:b({urconst:t,refSuffix:{t:T.Cd.WATCHED,n:1}}),text:P};case u.qcL.Review:if(!a)return{href:W({urconst:t,refSuffix:{t:T.Cd.WATCHED,n:1}}),text:B};return{href:w({rwconst:a,refSuffix:{t:T.Cd.WATCHED,n:1}}),text:B}}},$=(0,c.useCallback)((e,t)=>{var a;return(a={updatedState:t,titleId:e}).updatedState?H(a.titleId):Y(a.titleId)},[]),V=(0,c.useCallback)(s()($,750,{leading:!0,trailing:!1}),[$]);return{isFetching:A||y,sendMarkTitleAsWatched:e=>V(e,!0),sendMarkTitleAsUnwatched:e=>V(e,!1)}}},11947:function(e,t,a){a.d(t,{A:function(){return o}});var r=a(52322);a(2784);var n=a(81999);let o=e=>(0,r.jsx)(n.BK,{...e})},66456:function(e,t,a){a.d(t,{I:function(){return n}});var r=a(86958);let n=()=>r.B().context.sidecar?.account.userId}}]);